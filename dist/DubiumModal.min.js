/**
 * DubiumModal 0.0.1
 *
 * https://dubiumekb.github.io/DubiumModal/
 *
 * Copyright (c) 2022 Михаил Вострокнутов
 *
 * Released under the MIT License
 *
 * Released on: February 9, 2022
 */

class DubiumModal{constructor(i,o){this.options=Object.assign({overlay:!0,windowScroll:!1,modalScroll:!1,windowInCenter:!1,closeESC:!0,closeOutside:!0,show:!1,windowWidth:null,animationSpeed:300},o),this.name=i,this.body=document.body,this.speed=this.options.animationSpeed,this.isBtnModal=document.querySelector(`[data-dubiumModal-btn="${this.name}"]`),this.isDubiumModal=document.querySelector(`[data-dubiumModal="${this.name}"]`),this.name&&this.init()}init(){this.isDubiumModal.isOpened=!1,this.isBtnModal&&this.isDubiumModal?this.defaultModal():this.error()}searchSelectors(){this.btnModal=document.querySelectorAll(`[data-dubiumModal-btn="${this.name}"]`),this.dubiumModal=document.querySelector(`[data-dubiumModal="${this.name}"]`),this.closeDubiumModal=this.isDubiumModal.querySelectorAll('[data-dubiumModal-action="close"]'),this.modalVisible=document.querySelectorAll(".modal[data-dubiumModal]")}defaultModal(){switch(this.searchSelectors(),this.dubiumModal.style.setProperty("--dubium-modal-speed-animation",this.speed/1e3+"s"),this.open(),this.close(),this.options.show&&this.show(),this.options.closeESC&&this.closeESC(),this.options.closeOutside&&this.closeOutside(),this.options.overlay&&this.dubiumModal.classList.add("modal__overlay"),this.options.windowScroll&&this.dubiumModal.classList.add("modal__scroll--window"),this.options.modalScroll&&this.dubiumModal.classList.add("modal__scroll--modal"),this.options.windowInCenter&&this.dubiumModal.querySelector(".modal__dialog").classList.add("modal__dialog--center"),this.options.windowWidth){case"small":this.dubiumModal.querySelector(".modal__dialog").classList.add("modal__dialog--small");break;case"large":this.dubiumModal.querySelector(".modal__dialog").classList.add("modal__dialog--large");break;case"fullscreen":this.dubiumModal.querySelector(".modal__dialog").classList.add("modal__dialog--fullscreen")}}show(){this.closeHandler(),this.openHandler()}closeESC(){document.addEventListener("keydown",function(i){"Escape"==i.key&&this.isDubiumModal.isOpened&&this.closeHandler()}.bind(this))}closeOutside(){this.isDubiumModal.addEventListener("click",function(i){i.target.classList.contains("modal")&&this.isDubiumModal.isOpened&&this.closeHandler()}.bind(this))}open(){this.btnModal.forEach((i=>{i.addEventListener("click",function(){this.closeHandler(),setTimeout((()=>{this.openHandler()}),100)}.bind(this))}))}openHandler(){this.dubiumModal.isOpened=!0,this.dubiumModal.classList.add("show"),this.dubiumModal.removeAttribute("aria-hidden"),this.dubiumModal.setAttribute("role","dialog"),document.body.scrollHeight!==window.innerHeight&&this.body.classList.add("modal__visible")}close(){this.closeDubiumModal.forEach((i=>{i.addEventListener("click",function(){this.isDubiumModal.isOpened&&this.closeHandler()}.bind(this))}))}closeHandler(){this.modalVisible.forEach((i=>{i.classList.contains("show")&&(i.isOpened=!1,i.classList.remove("show"),i.classList.add("hide"),setTimeout((function(){i.classList.remove("hide")}),this.speed),i.setAttribute("aria-hidden",!0),i.removeAttribute("role","dialog"),document.body.scrollHeight!==window.innerHeight&&this.body.classList.remove("modal__visible"),this.dubiumModal.isOpened=!1)}))}error(){null==this.isBtnModal&&null==this.isDubiumModal&&console.error(`Button and modal window parameter not found: ${this.name}`),null==this.isBtnModal&&console.error(`Button parameter not found: ${this.name}`),null==this.isDubiumModal&&console.error(`Modal window parameter not found: ${this.name}`)}errorRender(){null==this.render.title&&console.error("Add text to the property: title"),null==this.render.body&&console.error("Add text to the property: body"),null==this.render.footer&&console.info("Add text to the property: footer")}}